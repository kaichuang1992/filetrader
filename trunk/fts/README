-- REQUIREMENTS --
* php-pecl-oauth (http://pecl.php.net/package/oauth)
	==> Fedora Package (php-pecl-oauth)
		http://admin.fedoraproject.org/updates/php-pecl-oauth
		(Currently in testing for F14/F15, soon to be pushed to stable)

	==> Debian Package
		Not in Debian as far as I know (use "pecl install oauth")
		
* mod_xsendfile (+ web server configuration!)
	==> Fedora Package (mod_xsendfile)

	==> Debian Package (libapache2-mod-xsendfile)

* php-pdo (+ sqlite)
	==> Fedora Package (php-pdo)
		In Fedora this package contains the SQlite driver

	==> Debian Package (php5-sqlite)
		Also contains SQlite PDO driver

* 64 bit OS and PHP installation (for >2G file support)

--- INSTALLATION ---

It is assumed you placed the source files of fts in /var/www/html/fts. This
is the default directory on Red Hat based systems. On Debian this would
be /var/www/fts.
 
# create data directory
$ mkdir -p data

# set unix permissions
$ chmod o+w -R data

*** WARNING ***
Make sure the data directory is not accessible through the web browser,
use a .htaccess file to limit access to directory structure!

        echo "Deny from all" > data/.htaccess

Make sure Apache allows the use of "Limit" as override in your (virtual host)
directory (see below for more Apache configuration hints):

        AllowOverride Limit

--- SELINUX CONFIGURATION ---

Set the correct SELinux labels (only for Fedora/Red Hat systems?)

$ chcon -R -t httpd_sys_rw_content_t data

--- CONFIGURATION ---

Copy config.php.default to config.php and modify it for your situation
(if needed).

In order to configure storage consumers it is recommended to use a 
reasonable length secrets. The provided tool in the "tools" directory
will create them for you!

$ php tools/manageConsumer.php add [NAME OF CONSUMER]

For example:

$ php tools/manageConsumers.php add "http://my.university.org"
consumerKey: [http://my.university.org], consumerSecret: [421398aec34678f1efc506a08f36446d]

You can list the configured consumers using:

$ php tools/manageConsumers.php list
*** LIST OF STORAGE CONSUMERS ***
[KEY]    = http://my.university.org
[SECRET] = 421398aec34678f1efc506a08f36446d
[PATH]   = /var/www/html/filetrader/fts/data/http%3A%2F%2Fmy.university.org

NOTE: The key and secret should be configured in the remote consumer that is 
accessing this service. The path is the location on the local file system where
files belonging to this consumer will be stored.

--- APACHE CONFIGURATION ---

To support the X-Sendfile header Apache needs to be configured to allow for this
header. Set:

    XSendFile on

    # on Debian (SendFile module 0.9) you seem to need this option as well:
    ### XSendFileAllowAbove on

In the (virtual) directory configuration containing the scripts (see https://tn123.org/mod_xsendfile/). 

For example:

<Directory "/var/www/html">
    Options Indexes FollowSymLinks
    AllowOverride Limit
    XSendFile on
    # on Debian (SendFile module 0.9) you seem to need this option as well:
    ### XSendFileAllowAbove on
    Order allow,deny
    Allow from all
</Directory>

--- ISSUES ---

We are using a persistent database connection to the SQlite file, which means that 
if you remove the file from the file system writing to the database still seems 
to work, but reading from it fails or something like that... A solution is to
restart Apache/PHP when doing this...

